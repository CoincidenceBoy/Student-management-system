## MODEL PROBLEMS标准示例模型问题学习

(网址：http://www.cs.cmu.edu/~ModProb/index.html)

### 1.*Keyword in Context (KWIC)* 上下文关键字

问题描述：给定一组线，创建这些线的旋转字母顺序列表。

从Parnas [Parnas72]中，我们对上下文问题中的关键字有一个简洁的定义 ：

KWIC索引系统接受一组有序的行，每行是一组有序的单词，并且每个单词是一组有序的字符。通过重复删除第一个单词并将其附加在该行的末尾，可以“循环移动”任何行。KWIC索引系统以字母顺序输出所有行的所有循环移位的列表。

#### 1.1历史

上下文索引已经使用了很多年。例如，圣经的一致性大约具有这种形式，除了旋转。但是，现在已知的常见问题来源是Parnas定义。

在1972年的论文中，帕纳斯（Parnas）使用该问题对比了将系统分解为模块的不同标准[Parnas72]。他描述了两种解决方案，一种基于共享数据访问权限的功能分解，另一种基于隐藏设计决策的分解。后者被用来促进信息隐藏，这是抽象数据类型和面向对象设计的基础。自引入以来，该问题已众所周知，并已广泛用作软件工程中的教学设备。Garlan，Kaiser和Notkin也使用该问题来说明基于数据驱动工具调用[Garlan92]的模块化方案，有时称为反应性集成。

尽管可以将KWIC实施为一个相对较小的系统，但它并不仅仅具有教学意义。它的实际实例被计算机科学家广泛使用。例如，Unix手册页的“置换” [sic]索引本质上就是这样的系统。

我们在软件体系结构课程中使用该问题，以向学生提供不同体系结构样式的软件开发经验[GarlanShaw94]。我们给三个独立的任务。每一个都以一个简单的KWIC索引器开始，我们为其提供代码，并要求进行修改。通过提供一个初始实现，我们以他们感兴趣的方式为他们提供了一个小型系统的示例，并以正确的方式使其入门。每个练习都需要以保留样式的方式进行修改。作为作业的一部分，学生将在基本问题上分析不同样式对不同变体的适用性。

#### 1.2设计注意事项

从软件体系结构的角度来看，该问题之所以吸引人，是因为它可以用来说明变更对软件设计的影响。帕纳斯（Parnas）表明，不同的问题分解在承受设计变更的能力方面差异很大。他认为的变化包括：

- 算法上的变化：例如，可以在从输入设备读取时在每一行上执行换行，也可以在读取后的所有行上进行换行，或者在按字母顺序排列需要一组新的换行时按需进行换行。
- 数据表示形式的更改：例如，可以以多种方式存储行。同样，循环移位可以显式或隐式存储（作为索引和偏移量）。

Garlan，Kaiser和Notkin [Garlan92]通过包括增强系统功能来扩展Parnas的分析。例如：

- 让系统消除以某些杂音词（例如“ a”，“ an”，“ and”等）开头的循环移位。
- 使系统具有交互性，并允许用户从列表中删除行。

最后，值得考虑的架构解决方案基于以下方面的差异：

- 性能：时空兼具。
- 重用：组件可以在多大程度上用作可重用实体。

#### 1.3解决方案

对于上下文关键字（KWIC）体系结构模型问题，我们有四个解决方案。所有这四个都基于已发布的解决方案。前两个是在Parnas的原始文章中考虑的那些。第三种解决方案基于“反应性集成”的使用，代表了Garlan，Kaiser和Notkin 研究的解决方案的一种变体。第四个是受Unix索引实用程序启发的管道解决方案。

##### 解决方案1：具有共享数据的主程序/子例程。

第一种解决方案根据执行的四个基本功能分解问题：输入，移位，字母和输出。这些计算组件由主程序协调为子例程，该子程序依次对它们进行排序。数据通过共享存储（“核心存储”）在组件之间进行通信。计算组件和共享数据之间的通信是不受约束的读写协议。这是因为协调程序保证了对数据的顺序访问。

具有共享数据的分层子例程体系结构如下：

![img](http://www.cs.cmu.edu/~ModProb/kwic-main-sub.gif)

在此解决方案中，计算可以共享相同的存储。这允许有效的数据表示。该解决方案还具有一定的直观吸引力，因为不同的计算方面被隔离在不同的模块中。

但是，正如帕纳斯（Parnas）所说，就其处理变更的能力而言，它具有许多严重的缺点。特别是，数据存储格式的更改将影响几乎所有模块。同样，算法更改和系统功能增强也不容易处理。

最后，由于系统的每个模块都与该特定应用程序紧密相关，因此不能很好地支持重用。

##### 解决方案2：抽象数据类型。

第二种解决方案将系统分解为五个模块的相似集合。但是，在这种情况下，数据不再由计算组件直接共享。而是，每个模块提供一个接口，该接口允许其他组件仅通过调用该接口中的过程来访问数据。

抽象数据类型架构如下：

![img](http://www.cs.cmu.edu/~ModProb/kwic-adt.gif)

该解决方案由与第一个相同的处理模块组成。但是，考虑到设计变更时，与第一个解决方案相比，它具有许多优势。特别是，算法和数据表示形式都可以在单个模块中进行更改，而不会影响其他模块。此外，与第一种解决方案相比，更好地支持重用，因为模块对与它们交互的其他模块的假设较少。

另一方面，正如Garlan，Kaiser和Notkin所讨论的那样，该解决方案并非特别适合增强功能。主要问题是，要向系统添加新功能，实现者必须修改现有模块-损害其简单性和完整性-或添加导致性能下降的新模块。

##### 解决方案3：反应性集成。

与第一种解决方案类似，第三种解决方案使用基于共享数据的组件集成形式。但是，有两个重要区别。首先，数据接口更加抽象。而不是将存储格式公开给计算模块，而是抽象地访问数据（例如，作为列表或集合）。其次，在修改数据时隐式调用计算。例如，将新行添加到行存储器的操作导致将事件发送到班次模块。这允许它产生循环移位（在单独的抽象共享数据存储中）。这又导致隐式调用字母顺序化程序，以便可以对行进行字母顺序化。关于这种集成范例的其他讨论可以在其他地方找到。

反应式架构如下：

![img](http://www.cs.cmu.edu/~ModProb/kwic-reactive.gif)

该解决方案轻松支持系统的功能增强：通过注册在某些事件上要调用的其他模块，可以将其附加到系统。由于数据是抽象访问的，因此它也使计算与数据表示形式的更改隔离开来。还支持重用，因为隐式调用的模块仅依赖于某些外部触发事件的存在。

但是，该解决方案受到以下事实的困扰：可能很难更改隐式调用的模块的处理顺序。此外，由于调用是由数据驱动的，因此使用这种分解的最自然的解决方案倾向于比以前考虑的分解占用更多的空间。

##### 解决方案4：数据流。

第四个解决方案使用管道。管道由一系列过滤器组成，这些过滤器通过数据流连接。在这种情况下，有四个过滤器：输入，移位，字母和输出。每个过滤器处理其数据，并将其发送到下游过滤器。控制是分布式的：每个过滤器只要有要计算的数据就可以运行。过滤器之间的数据共享严格限于通过管道传输的数据。

数据流架构如下：

![img](http://www.cs.cmu.edu/~ModProb/kwic-dataflow.gif)

该解决方案具有几个不错的属性。首先，它支持直观的处理流程。其次，它支持重用，因为每个过滤器都可以独立运行（提供的上游过滤器以预期的形式生成数据）。通过在处理顺序的适当位置插入过滤器，可以轻松地将新功能添加到系统中。

另一方面，它具有许多缺点。首先，实际上不可能修改设计以支持交互式系统。例如，为了删除一行，必须有一些持久的共享存储，这违反了该方法的基本原则。其次，由于每个过滤器必须将所有数据复制到其输出端口，因此该解决方案在空间使用方面效率很低。



### 2.*Sea Buoy*海浮标

问题描述：自动和按需收集和传输天气数据；允许抢占紧急服务。

海浮标支持海上航行。这是来自[Booch86]的问题说明：

有一系列自由漂浮的浮标，可为海上空中航行和船舶交通提供导航和天气数据。浮标通过各种传感器收集空气和水的温度，风速和位置数据。每个浮标可能具有不同数量的风和温度传感器，并且将来可能会进行修改以支持其他类型的传感器。每个浮标还配备有无线电发射器（用于广播天气和位置信息以及SOS消息）和无线电接收器（用于接收来自经过船只的请求。某些浮标配有红灯，可能会被一个红灯激活）。在海上搜索操作中经过的船只。如果水手能够到达浮标，则他或她可以翻转浮标侧面的开关以启动SOS广播。每个浮标的软件必须：

- 保持当前的风，温度和位置信息；每30秒获取一次风速读数，每10秒获取一次温度读数，每10秒获取一次位置；风和温度值保持为运行平均值。
- 每60秒广播一次当前的风，温度和位置信息
- 根据过往船只的要求，广播过去24小时的风，温度和位置信息；这比定期广播优先
- 根据经过的船只的请求激活或停用红灯。
- 水手使用紧急开关后，连续播放SOS信号；该信号的优先级高于所有其他广播，并且一直持续到经过的船只重置为止。

#### 2.1历史

浮标问题是由Parnas等人于1981年作为“软件工程原理”课程的示例提出的。他们将其用作体系结构示例，通过比较两种不同的可能设计来说明实时系统设计的原理，其中一种是这是可以维护的，而其中之一则不能维护。

Booch使用海浮标示例来说明面向对象的开发[Booch86]。他根据Boehm-Davis和Ross [Boehm84]的研究改编了他的版本。

从体系结构的角度来看，有趣的问题在于可以对其进行分析的不同级别。如下一节所述，可维护性，实时因素和硬件问题都是重要的考虑因素。

#### 2.2设计注意事项

问题陈述定义了一组单独的功能，它们的共同点相对较少。他们共享通信设备和许多当前的传感器读数。

软件体系结构必须允许集成这些松散耦合的功能（要求R1）。

同时，它必须尊重其优先级和时序约束（R2）。

显然，可以通过附加功能（例如，更多传感器）进一步扩展系统，或者可以修改优先级和时序约束。因此，该体系结构应允许修改整个系统参数（R3）。

最后，海浮标必须长时间运行而无需维护，而且它们的数量众多，因此成本成为主要考虑因素。因此，该体系结构应为在最基本的平台（R4）上实施提供提示。

#### 2.3解决方案

Booch在与问题陈述[Booch86]相同的论文中提供了面向对象的解决方案。

